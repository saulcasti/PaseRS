<div id="widget-chat" style="margin-top: 5%"
		class="chat-panel panel panel-default">
	<div class="panel-heading">
		<h2 class="text-center">Chat</h2>
		<hr>

	</div>
	<div class="panel-body"
		 id="chatList">

		<ul class="chat" id="chat">
			<!-- Aquí irán los mensajes -->
		</ul>
	</div>

	<form class="form-horizontal"  enctype="multipart/form-data">
		<div class="panel-footer">
			<div class="input-group">
				<input id="btn-input" type="text" class="form-control input-sm"
					   placeholder="Introduce tu mensaje..." name="contenido" /> <span class="input-group-btn">
						<button class="btn btn-danger" id="btn-chat">Enviar</button>
					</span>
			</div>
		</div>
	</form>
	<hr>
	<button style="margin-top: 1%" class="btn btn-outline-success btn-lg btn-block" onclick="widgetFriendsList()" >Volver</button>

	<script>

        $.ajax({
            url : URLbase + "/mensaje/"+ idChatSeleccionada,
            type : "GET",
            data : {},
            dataType : 'json',
            headers : {
                "token" : token
            },
            success : function(mensaje) {
                //console.log(mensaje);
                mostrarMensajes(mensaje);

            },
            error : function(error) {
                $("#contenedor-principal").load("widget-login.html");
            }
        });

        window.onload= function(){
            var chatBox;
            chatBox = $('#chatList');
            chatBox.scrollTop = chatBox.scrollHeight;
            $('#btn-input').focus()
        };


        function widgetFriendsList() {
            $("#contenedor-principal").load("widget-listFriends.html");
		};


        function mensajeRecibido(autor, texto) {
            var mensaje =
       				"<li class='list-group-item  list-group-item-primary col-9' style='list-style:none; float:left; margin-bottom: 5%;'>"
               			+ "<div id='mensajeAmigo'>"
                				+ "<div class='row'>"
                					+"<strong class='col text-left' >" + autor + "</strong>"
									+"<small class='col text-right'>"+ "fecha y hora"+"</small></div>"
            					+ "<div class='row'>"
               					+" <p  class='col text-left'>"+texto+"</p></div></div></li>";
			$("#chat").append(mensaje);
        }

        function mensajeMandado(autor, texto) {
            var mensaje =
                "<li class='list-group-item  list-group-item-warning col-9' style='list-style:none; float:right; margin-bottom: 5%;'>"
                + "<div id='mensajePropio'>"
                + "<div class='row'>"
                +"<small class='col text-text-left'>"+ "fecha y hora"+"</small>"
                +"<strong class='col text-right' >" + autor + "</strong></div>"

                + "<div class='row'>"
                +" <p  class='col text-right'>"+texto+"</p></div></div></li>";
            $("#chat").append(mensaje);
        }

        function mostrarMensajes(mensaje) {
            var izq = mensaje[0].emisor;
            var dch = mensaje[0].destino;

            for(var i=0; i< mensaje.length;i++){
                if(mensaje[i].emisor == dch){
                    mensajeRecibido(dch, mensaje[i].text)
				}
				else{
                    mensajeMandado(izq,mensaje[i].text);
				}
			}
        }

	</script>
</div>